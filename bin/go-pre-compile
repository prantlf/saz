#!/bin/sh
go get -u github.com/go-bindata/go-bindata/v3/...
go get -u github.com/tdewolff/minify/v2/...

SOURCE_DIR=cmd/sazserve/sources
ASSET_DIR=cmd/sazserve/assets
ASSET_BIN=cmd/sazserve/assets.go

mkdir -p $ASSET_DIR/css $ASSET_DIR/js
"$GOBIN/minify" -o $ASSET_DIR/js/all.min.js $SOURCE_DIR/js/jquery.js \
	$SOURCE_DIR/js/bootstrap.bundle.js $SOURCE_DIR/js/datatables.js $SOURCE_DIR/js/saz.js
"$GOBIN/minify"  -o $ASSET_DIR/css/common.min.css $SOURCE_DIR/css/datatables.css \
	$SOURCE_DIR/css/saz.css
"$GOBIN/minify"  -o $ASSET_DIR/css/bootstrap.flatly.min.css $SOURCE_DIR/css/bootstrap.flatly.css
"$GOBIN/minify"  -o $ASSET_DIR/css/bootstrap.darkly.min.css $SOURCE_DIR/css/bootstrap.darkly.css
"$GOBIN/minify"  -o $ASSET_DIR/css/saz.darkly.min.css $SOURCE_DIR/css/saz.darkly.css

"$GOBIN/go-bindata" -fs -o $ASSET_BIN -prefix $ASSET_DIR $ASSET_DIR/...
go run internal/move-generated-comments/move-generated-comments.go -- $ASSET_BIN
